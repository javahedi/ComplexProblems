import numpy as np

def strain(ex,ey,ez,Hopping):
    
    
    #################################################
    #################################################
    #################################################
    # lattice parameters
    r1 = 22.40  # nm
    r2 = 22.80
    a = 45.80
    b = 33.20
    
    r1x0, r1y0, r1z0 =        15.03, 16.60,    0.0
    r2x0, r2y0, r2z0 =         7.86,   0.0,  21.40
    #r3x0, r3y0, r3z0 =  r1x0+2*r2x0,   b/2,    0.0
    #r4x0, r4y0, r4z0 =    r1x0+r2x0,   b/2,  21.40
    #r5x0, r5y0, r5z0 =            a,   0.0,  21.40
    
    r10 = [      15.03, 16.60,    0.0]
    r20 = [       7.86,   0.0,  21.40]
    r30 = [r1x0+2*r2x0,   b/2,    0.0]
    r40 = [  r1x0+r2x0,   b/2,  21.40]
    r50 = [          a,   0.0,  21.40]
    
    
    strain = np.array([[1+ex,0,0],[0,1+ey,0],[0,0,1+ez]])
    r1 = np.dot(strain,r10)
    r2 = np.dot(strain,r20)
    r3 = np.dot(strain,r30)
    r4 = np.dot(strain,r40)
    r5 = np.dot(strain,r50)
    
    k1x = (r10[0]/np.sqrt(r10[0]**2+r10[1]**2+r10[2]**2))**2
    k1y = (r10[1]/np.sqrt(r10[0]**2+r10[1]**2+r10[2]**2))**2
    k1z = (r10[2]/np.sqrt(r10[0]**2+r10[1]**2+r10[2]**2))**2
    
    k2x = (r20[0]/np.sqrt(r20[0]**2+r20[1]**2+r20[2]**2))**2
    k2y = (r20[1]/np.sqrt(r20[0]**2+r20[1]**2+r20[2]**2))**2
    k2z = (r20[2]/np.sqrt(r20[0]**2+r20[1]**2+r20[2]**2))**2
    
    k3x = (r30[0]/np.sqrt(r30[0]**2+r30[1]**2+r30[2]**2))**2
    k3y = (r30[1]/np.sqrt(r30[0]**2+r30[1]**2+r30[2]**2))**2
    k3z = (r30[2]/np.sqrt(r30[0]**2+r30[1]**2+r30[2]**2))**2
    
    k4x = (r40[0]/np.sqrt(r40[0]**2+r40[1]**2+r40[2]**2))**2
    k4y = (r40[1]/np.sqrt(r40[0]**2+r40[1]**2+r40[2]**2))**2
    k4z = (r40[2]/np.sqrt(r40[0]**2+r40[1]**2+r40[2]**2))**2
    
    k5x = (r50[0]/np.sqrt(r50[0]**2+r50[1]**2+r50[2]**2))**2
    k5y = (r50[1]/np.sqrt(r50[0]**2+r50[1]**2+r50[2]**2))**2
    k5z = (r50[2]/np.sqrt(r50[0]**2+r50[1]**2+r50[2]**2))**2
    
    t1 = (1-2*k1x*ex-2*k1y*ey-2*k1z*ez)*Hopping[0]
    t2 = (1-2*k2x*ex-2*k2y*ey-2*k2z*ez)*Hopping[1]
    t3 = (1-2*k3x*ex-2*k3y*ey-2*k3z*ez)*Hopping[2]
    t4 = (1-2*k4x*ex-2*k4y*ey-2*k4z*ez)*Hopping[3]
    t5 = (1-2*k5x*ex-2*k5y*ey-2*k5z*ez)*Hopping[4]
    #################################################
    return [t1, t2, t3, t4, t5]
    
    